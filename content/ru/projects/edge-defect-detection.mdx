---
title: "Детекция дефектов на edge-устройствах"
summary: "Создал компактную CV-модель и on-device пайплайн для контроля качества в реальном времени при жестких бюджетах по задержке."
tags: ["CV", "MLOps"]
stack: ["PyTorch", "ONNX Runtime", "TensorRT", "Kubernetes", "Prometheus"]
metrics: ["Recall 0.92@0.10 FPR", "Задержка 45мс (устройство)", "Доля брака −9%"]
role: "Инженер по машинному обучению"
year: 2023
links:
  github: "https://github.com/your-handle/edge-defect"
featured: false
slug: "edge-defect-detection"
---

## Проблема / контекст

Производственной линии требовалась автоматическая инспекция визуальных дефектов. Основные сложности — **переменное освещение**, **редкие дефекты** и **жесткий on-device бюджет по задержке**.

Цели:

- End-to-end задержка &lt; 60мс
- Высокий recall при низком FPR
- Простая выкладка и мониторинг

## Подход / пайплайн

Собрал компактный детектор + постобработку, устойчивую к дрейфу освещения.

- Модель: легкий backbone, focal loss, усиленные аугментации
- Постобработка: калибровочные пороги на станцию
- Деплой: ONNX Runtime / TensorRT на edge-девайсах + сервис-наблюдатель

```text
[Camera] -> [Preprocess] -> [Model] -> [Calibrated Threshold] -> [Defect Event]
                                              |
                                              v
                                      [Metrics + Traces]
```

## Данные

- Сбалансированный датасет с активным обучением
- Добавил *hard negatives* из почти-дефектных примеров
- Версионирование датасетов как неизменяемых артефактов

## Результаты

- **Recall 0.92 @ 0.10 FPR** на отложенной валидации
- **Задержка 45мс** на целевом железе
- **Доля брака −9%** после раскатки и обратной связи операторов

## Мониторинг

Edge-сервис эмитит короткий, высокосигнальный набор метрик:

- дрейф: расстояние в эмбеддингах
- качество: частота алертов, доля ручных отмен
- производительность: гистограммы задержек по стадиям

## Что улучшить

- Расширить синтетические аугментации для редких дефектов
- Добавить непрерывные проверки калибровки по станциям
